# 计算机网络

## 第一章 计算机网络体系结构

### 1.计算机网络概述

#### 1.概念,组成,功能,分类

三网--有线电视网络,电信网络,计算机网络

四网--有线电视网络,电信网络,计算机网络,电网

计算机网络--是一个将分散的,具有独立功能的**计算机系统(包括手机系统和电脑系统)**,通过**通信设备**与**线路**连接起来,由功能完善的**软件**实现**资源共享**和**信息传递**的系统

计算机网络是**互联**的,**自治**的计算机集合
互联--通过通信链路互联互通
自治--无主从关系

计算机网络的功能--

- 数据通信
- 资源共享--同一个计算机网络上的其他计算机可使用某台计算机资源的行为,可共享**硬件(打印机),软件,数据**
- 分布式处理--多台计算机各自承担同一工作任务的不同部分
  - 提高可靠性--替换机
  - 负载均衡--各计算机之间更亲密

计算机网络的发展--

1. 美国国防部高级研究计划局(ARPA)设计的一个分散的指挥系统--ARPAnet(阿帕网),通过无线分组交换网&卫星通信网连接
2. 1983 年阿帕网接受 TCP/IP 协议,选定 Internet 为主要的计算机通信系统
3. 1985 年起,美国国家科学基金会 NSF 围绕 6 个大型计算机中心建设计算机网络,即国家科学基金网**NSFNET**.具有**三级结构**--校园网/企业网 → 地区网 → 主干网
4. 多层次 ISP 结构.ISP--因特网服务提供者/因特网服务提供商,是一个向广大用户综合提供互联网接入业务,信息业务和增值业务的公司.如中国移动等.分为主干 ISP,地区 ISP,本地 ISP.
   主机 A→ 本地 ISP→ 地区 ISP→ 主干 ISP→ 地区 ISP→ 本地 ISP→ 主机 B

网络把许多计算机连接在一起
互联网把许多网络连接在一起
因特网是世界上最大的互联网

计算机网络的组成--

- 硬件
- 软件
- 协议(一系列规则和约定的集合)

计算机网络的工作方式--

- 边缘部分--用户直接使用
  - C/S 方式
  - P2P 方式
- 核心部分--网络和通信设备,为边缘部分服务

计算机网络的功能组成--

- 通信子网--实现**数据通信**
- 资源子网--实现**资源共享**/数据处理

|   ---    |   应用层   |               |
| :------: | :--------: | :-----------: |
| 资源子网 |   表示层   |               |
|   ---    |   会话层   |               |
|          |   传输层   |               |
|   ---    |   网络层   |    路由器     |
| 通信子网 | 数据链路层 |  交换机,网桥  |
|   ---    |   物理层   | 集线器,中继器 |

计算机网络的分类--

- 按分布范围分--
  - 个人局域网 PAN
  - 局域网 LAN(广播技术)
  - 城域网 MAN
  - 广域网 WAN(交换技术)
- 按使用者分--
  - 公用网
  - 专用网
- 按交互技术分--
  - 电路交换
  - 报文交换
  - 分组交换
- 按拓扑结构分--
  - 总线型
  - 星型
  - 环型
  - 网状型
- 按传输技术分--
  - 广播式网络--共享公共通信信道
  - 点对点网络--使用**分组存储转发**和**路由选择**机制

#### 2.标准化工作及相关组织

标准的分类--

- 法定标准--由权威机构制定的正式的,合法的标准.如 OSI
- 事实标准--某些公司的产品在竞争中占据了主流,这些产品中的协议和技术就成了标准.如 TCP/IP

RFC(Request For Comments)--因特网标准的形式

RFC 要上升为因特网正式标准的四个阶段--

1. 因特网草案(Internet Draft).这个阶段还不是 RFC 文档
2. 建议标准(Proposed Standard).从这个阶段开始成为 RFC 文档
3. 草案标准(Draft Standard).(2021 年后被取消)
4. 因特网标准(Internet Standa)

标准化工作的相关组织--

- 国际标准化组织 ISO--OSI 参考模型,HDLC 协议
- 国际电信联盟 ITU--制定通信规则
- 国际电气电子工程师协会 IEEE--学术机构,IEEE802 系列标准,5G
- Internet 工程任务组 IETF--负责因特网相关标准的制定,如 RFC XXXX

#### 3.性能指标

##### 1.速率,带宽,吞吐量

速率--数据率或数据传输率或比特率

带宽原指某个信号具有的频带宽度,即最高频率与最低频率之差,单位是赫兹(Hz)

在计算机网络中,带宽用来表示网络的通信线路传送数据的能力,通常是指单位时间内从网络中的某一点到另一点所能通过的**最高数据率**.也是网络设备所支持的最高速度.单位是比特每秒.

吞吐量--表示在**单位时间**内通过**某个网络**(或信道,接口)的数据量.单位 b/s,kb/s,Mb/s 等

吞吐量受网络的带宽或网络的额定速率的限制

##### 2.时延,时延带宽积,往返时间 RTT,利用率

时延--指数据(报文/分组/比特率)从网络(或链路)的一端传送到另一端所需要的时间.也叫延迟或迟延.单位是秒

- 发送时延--结点将分组的所有比特推向(传输)链路所需的时间,即从发送分组的第一个比特算起,到该分组的最后一个比特发送完毕所需要的时间,因此也被称为**传输时延**.
  计算公式为--发送时延=分组长度/信道宽度
- 传播时延--电磁波在信道中传播一定的距离需要花费的时间,即一个比特从链路的一段传播到另一端所需要的时间
  计算公式--传播时延=信道长度/电磁波在信道上的传播速率
- 排队时延--分组在进入路由器后要先在输入队列中排队等待处理.路由器确定转发端口后,还要在输出队列中等待转发,产生了排队时延
- 处理时延--数据在交换结点为存储转发而进行的一些必要的处理所花费的时间.如分析分组的首部,从分组中提取数据部分,进行差错检验等

总时延=发送时延+传播时延+排队时延+处理时延

时延带宽积--指发送端发送第一个比特即将到达终点时,发送端已经发出了多少个比特,因此又称以比特为单位的链路长度,即"某段链路现在又多少比特".即时延带宽积=传播时延 X 带宽

往返时延(Round-Trip Time,RTT)--指从发送端发出一个短分组,到发送端收到来自接收端的确认(接收端收到数据后立即发送确认),总共经历的时延.在互联网中,往返时延还包括各中间结点的处理时延,排队时延及转发数据时的发送时延

利用率--

- 信道利用率--有数据通过时间/(有+无)数据通过时间
- 网络利用率--信道利用率加权平均值.随利用率的增加,时延**急剧**增大

### 2.计算机网络体系结构与参考模型

#### 1.分层结构

网络体系结构是从**功能**上描述计算机网络结构的

计算机网络体系结构是计算机网络的**各层及其协议的集合**

体系结构是**抽象**的,而实现是指能运行的一些软件和硬件

分层的基本原则--

- 每层都实现一种相对独立的功能,降低大系统的复杂度
- 各层之间界面自然清晰,易于理解,相互交流尽可能少
- 各层功能的精确定义独立于具体的实现方法,可以采用最合适的技术来实现
- 保持下层对上层的独立性,上层单向使用下层提供的服务
- 整个分层结构能促进标准化工作

分层后各层之间相对独立,灵活性好,因此分层的体系结构易于更新(替换单个模块),易于调试,易于交流,易于抽象,易于标准化.

层次越多,不同层中重复出现的功能越多,产生额外的开销,整体的运行效率越低.
层次越少,每层的协议越复杂
在分层时应考虑层次的清晰程度与运行效率之间的折中,层次数量的折中

在计算机网络的分层结构中,第 n 层中的活动元素通常称为第 n 层实体.具体来说,实体指任何可发送或接受信息信息的硬件或软件进程,通常是一个特定的软件模块.

不同机器上的同一层称为**对等层**,同一层的实体称为**对等实体**.

第 n 层实体实现的服务为第 n+1 层所使用,在这种情况下,第 n 层称为**服务提供者**,第 n+1 层则服务于用户

在各个层次中,每个报文都分为两部分--数据部分(SDU),控制信息部分(PCI),他们共同组成 PDU

- 服务数据单元(SDU)--为完成用户所要求的功能而传送的数据.第 n 层的服务数据单元记为 n-SDU
- 协议控制信息(PCI)--控制协议操作的信息.第 n 层的协议控制信息记为 n-PCI
- 协议数据单元(PDU)--对等层次直接传送的数据单位称为该层的 PDU.第 n 层的协议数据单元记为 n-PDU
  - 物理层的 PDU 称为比特
  - 数据链路层的 PDU 称为帧
  - 网络层的 PDU 称为分组
  - 传输层的 PDU 称为报文段

各层间传输数据时,把第 n+1 层收到的 PDU 作为第 n 层的 SDU,加上第 n 层的 PCI,就变成了第 n 层的 PDU,交给第 n-1 层后作为 SDU 发送.接受方接收时做相反的处理.三者的关系如下--

$$
n-SDU+n-PCI=n-PDU=(n-1)-SDU
$$

层次结构的含义--

- 第 n 层的实体不仅要使用第 n-1 层的服务来实现自身定义的功能,还要向第 n+1 层提供本层的服务,该服务是第 n 层及其下面各层提供的服务总和
- 最底层只提供服务.是整个层次结构的基础,中间各层既是下一层的服务使用者,又是上一层的服务提供者,最高层面向用户提供服务
- 上一层只能通过相邻层间的接口使用下一层的服务,而不能调用其他层的服务,下一层所提供服务的实现细节对上一层透明(完全屏蔽)
- 两台主机通信时,对等层在逻辑上有一条直接信道,表现为不经过下层就能把信息送到对方

#### 2.协议,接口,服务

协议,就是规则的集合

为进行网络中的数据交换而建立的规则,标准或约定称为网络协议(Network Protocol),它是控制两个(或多个)对等实体进行通信的规则的集合,是水平的.不对等实体之间没有协议.网络协议简称为协议

协议组成--

- 语法--规定了传输数据的格式
- 语义--规定了所要完成的功能(需要发出何种控制信息,完成何种动作,做出何种应答)
- 同步--规定了执行各种操作的条件,时序关系等.即事件实现顺序的详细说明

一个完整的协议通常应该具有线路管理(建立,释放连接),差错控制,数据转换等功能

接口是同一结点内相邻两层间**交换信息的连接点**,是一个系统的内部规定

每层只能为紧邻的层次之间定义接口,不能跨层次定义接口.

在典型的接口上,同一结点相邻的两层实体通过服务访问点(Service Access Point,SAP)进行交互.服务是通过 SAP 提供给上层使用的,第 n 层的 SAP 就是第 n+1 层可以访问第 n 层服务的地方.每个 SAP 都有一个可以标识它的地址

服务是指下层为紧邻的上层提供的功能调用,它是垂直的.对等实体在协议的控制下,使得本层能为上一层提供服务,但要实现本层协议还需要使用下一层提供的服务

上层使用下层所提供的服务时必须与下层交换一些命令,这些命令在 OSI 参考模型中称为**服务原语**.OSI 参考模型将原语划分为 4 类--

- 请求(Request)--由服务用户发往服务提供者,请求完成某项工作
- 指示(Indication)--由服务提供者发送往服务用户,指示用户做某件事情
- 响应(Response)--由服务用户发往服务提供者,作为对指示的响应
- 证实(Confirmation)--由服务提供者发往服务用户,作为对请求的证实

有应答服务包含全部 4 种原语,无应答服务只有请求和指示两种原语

|  服务用户  |  实体(n+1)   |  ←  | 协议(n+1) |  →  |  实体(n+1)   | 第 n+1 层 |
| :--------: | :----------: | :-: | :-------: | :-: | :----------: | :-------: |
|            |      ↑       |     |           |     |      ↑       |           |
|            | 交换服务原语 |     |           |     | 交换服务原语 |           |
|            |      ↓       |     |           |     |      ↓       |           |
|            |     SAP      |     |           |     |     SAP      |           |
| 服务提供者 |   实体(n)    |  ←  |  协议(n)  |  →  |   实体(n)    |  第 n 层  |

计算机网络提供的服务--

- 面向连接服务和无连接服务
  - 面向连接服务--通信前双方必须先建立连接,分配相应的资源(如缓冲区),以保证通信能正常进行,传输结束后释放连接和所占用的资源.例如 TCP.这种服务可以分为--
    - 连接建立
    - 数据传输
    - 连接释放
  - 无连接服务--通信前双方不需要先建立连接,需要发送数据时可以直接发送.把每个带有目的地址的包(报文分组)传送到线路上,由系统选定路线进行传输.这是不可靠的服务.被描述为"尽最大努力交付"(Best-Effort-Delivery),它并不保证通信的可靠性.IP,UDP 就是无连接服务
- 可靠服务和不可靠服务
  - 可靠服务--网络具有纠错,检错,应答机制.能保证数据正确,可靠地传送到目的地
  - 不可靠服务--网络只是尽量正确,可靠地传送,而不能保证数据正确,可靠地传送到目的地,是一种尽力而为的服务
- 有应答服务和无应答服务
  - 有应答服务--接收方在收到数据后向发送方给出相应的应答,该应答由传输系统内部自动实现,而不由用户实现.所发送的应答可以是肯定应答,也可以是否定应答.通常在接收到的数据由错误时发送否定应答
  - 无应答服务--接受方收到数据后不自动给出应答.若要应答,则由高层实现

#### 3.ISO/OSI 模型

#### 4.TCP/IP 模型
